CREATE commands - 
------------------------

CREATE TABLE MANAGER
(MID VARCHAR2(5) PRIMARY KEY,
MName VARCHAR2(10) NOT NULL,
MPhone NUMBER(10) NOT NULL);

CREATE TABLE CUSTOMER
(CID VARCHAR2(5) PRIMARY KEY,
CName VARCHAR2(10) NOT NULL,
CPhone NUMBER(10) NOT NULL,
CAddress VARCHAR2(10) NOT NULL,
EMailID VARCHAR2(10) NOT NULL,
MID VARCHAR2(5) REFERENCES MANAGER(MID));

CREATE TABLE ORDERS
(OrderNo VARCHAR2(5) PRIMARY KEY,
No_of_items NUMBER(2) NOT NULL,
MID VARCHAR2(5) REFERENCES MANAGER(MID));

CREATE TABLE ITEM
(ItemNo VARCHAR2(5) PRIMARY KEY,
Description VARCHAR2(10) NOT NULL,
Price NUMBER(3) NOT NULL);

CREATE TABLE BILL
(BillNo VARCHAR2(5) PRIMARY KEY,
BillDate DATE NOT NULL,
TotalAmount NUMBER(5) NOT NULL);

CREATE TABLE ORDER_CONTENTS
(OrderNo VARCHAR2(5) REFERENCES ORDERS(OrderNo),
ItemNo VARCHAR2(5) REFERENCES ITEM(ItemNo),
Quantity NUMBER(2) NOT NULL,
PRIMARY KEY(OrderNo,ItemNo));

CREATE TABLE SERVICE
(CID VARCHAR2(5) REFERENCES CUSTOMER(CID),
OrderNo VARCHAR2(5) REFERENCES ORDERS(OrderNo),
PRIMARY KEY(CID,OrderNo));

CREATE TABLE BILL_GENERATION
(BillNo VARCHAR2(5) REFERENCES BILL(BillNo),
OrderNo VARCHAR2(5) REFERENCES ORDERS(OrderNo),
PRIMARY KEY(BillNo,OrderNo));

CREATE TABLE BILL_PAYMENT
(BillNo VARCHAR2(5) REFERENCES BILL(BillNo),
CID VARCHAR2(5) REFERENCES CUSTOMER(CID),
PRIMARY KEY(BillNo,CID));


INSERT Commands -
------------------------




Queries  - 
------------

1. Find the total amount generated by bills in the restaurant.
SELECT BillDate, SUM(TotalAmount) AS NetAmount
FROM BILL
GROUP BY BillDate;

2. Find the item which is ordered the most in the restaurant.
SELECT I.Description
FROM ITEM I,ORDER_CONTENTS O
WHERE O.ItemNo=I.ItemNo
GROUP BY I.Description
HAVING COUNT(O.ItemNo)>=ALL
(SELECT COUNT(ItemNo)
FROM ORDER_CONTENTS
GROUP BY ItemNo);

3. Display details of the manager who takes atleast 2 orders on a specific day.
SELECT *
FROM MANAGER M
WHERE EXISTS
(SELECT O.MID,BillDate
FROM BILL,ORDERS O
WHERE M.MID=O.MID
AND BillDate=date '2016-11-04'
GROUP BY BillDate
HAVING COUNT(O.MID)>=2);

4. Find the details of the customer who visits the restaurant most frequently.
SELECT *
FROM CUSTOMER C
WHERE EXISTS
(SELECT CID
FROM BILL B,BILL_PAYMENT BP
WHERE C.CID=BP.CID
AND B.BillNo=BP.BillNo 
GROUP BY CID
HAVING COUNT(BP.CID)>=ALL
(SELECT COUNT(BP.CID)
FROM BILL_PAYMENT
GROUP BY CID));

5. Find the name of the customer with maximum bill amount.
SELECT C.CName
FROM CUSTOMER C,BILL_PAYMENT BP,BILL B
WHERE C.CID=BP.CID
AND BP.BillNo=B.BillNo
AND B.TotalAmount>=ALL
(SELECT B1.TotalAmount
FROM BILL B1);
